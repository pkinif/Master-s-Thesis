---
title: "Mediation Analyses"
author: "Kinif Pierrick"
date: "8 avril 2018"
output: pdf_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, error = FALSE, results = 'asis')
```

```{r}
#Download package and database
rm(list=ls()) #Removes all items in Environment!
if (!require("mediation")) install.packages("mediation")
library(mediation)

if (!require("plm")) install.packages("plm")
library(plm)

# I dowload my DB with read.csv2
DB_Lag1<-data.frame(read.csv2("DataBase/Lag_1.csv", sep = ";",stringsAsFactors=FALSE, header = TRUE ))
```

Citation from @Baron1986 :

> To test mediation, one should estimate the three following regression equations: first, regressing the mediator on the independent variable; second, regressing the dependent variable on the independent variable; and third, regressing the dependent variable on both the independent variable and on the mediator. . . . To establish mediation, the following conditions must hold: First, the independent variable must affect the mediator in the first equation; second, the independent variable must be shown to affect the dependent variable in the second equation; and third, the mediator must affect the dependent variable in the third equation. (1986, 1177)

In my case :

A. Green Performance ~ Green Initiative
B. Financial performance ~ Green initiatives
C. Financial performance ~ green inititatives + green performance

According to [@Baron1986], there is a mediating effect if :

i) Green initiatives show statistical significance in both model 1 et ii) In model 3, green initiatives have to be non significant whereas Green Performance need to be significant


```{r}

#Test metiating effect with CFP = ROA and CEP = SustainableThemedCommitment

med.fit <- plm(SustainabilityPayLink ~ EnergyProductivity + CarbonProductivity + WaterProductivity + WasteProductivity + Leverage + NetMargin + FirmSize + Industry , model = "within", data = DB_Lag1, index = c("Companies", "YearFinancialIndicator"))

out.fit <- plm(ROA ~ SustainabilityPayLink + SustainableThemedCommitment + AuditScore + EnergyProductivity + CarbonProductivity + WaterProductivity + WasteProductivity + Leverage + NetMargin + FirmSize + Industry , model = "within", data = DB_Lag1, index = c("Companies", "YearFinancialIndicator"))

med.out <- mediate(med.fit, out.fit, sims = 500, boot = TRUE, boot.ci.type = "bca", treat = "SustainableThemedCommitment", mediator = "ROA")

```

